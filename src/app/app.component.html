<header>
  <div class="container nav">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <h1>Noticias360</h1>
    </div>

    <div class="nav-actions">
      <!-- BotÃ³n de tema -->
      <button class="btn" (click)="toggleTheme()">
        {{ themeLabel }}
      </button>


      <button
        class="btn subscribe-btn"
        (click)="openPlanes()">
        Suscribirme
      </button>




      <!-- Si NO estÃ¡ logueado â†’ botÃ³n Iniciar sesiÃ³n -->
      <button
        class="btn login-btn"
        *ngIf="!isLoggedIn()"
        (click)="goLogin()">
        Iniciar sesiÃ³n
      </button>

      <!-- Si SÃ estÃ¡ logueado â†’ nombre + menÃº -->
      <div class="user-wrapper" *ngIf="isLoggedIn() && user() as u">
        <button
          type="button"
          class="btn user-btn"
          (click)="toggleUserMenu()">
          {{ u.name }} {{ u.lastName }}
          <span class="chevron">âŒ„</span>
        </button>

        <!-- MenÃº desplegable -->
        <div class="user-menu" *ngIf="showUserMenu()">
          <button type="button" (click)="goProfile()">Perfil</button>
          <button type="button" (click)="logout()">Cerrar sesiÃ³n</button>
        </div>
      </div>
    </div>
  </div>
</header>

<main *ngIf="isLoggedIn(); else publicLayout">
  <div class="app-layout">
    <!-- BARRA LATERAL -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <span class="sidebar-title">Panel</span>
      </div>

      <nav class="sidebar-nav">
        <button class="sidebar-item" routerLink="/">
          ğŸ  Inicio
        </button>

        <button class="sidebar-item" routerLink="noticiasp">
          ğŸ“° Noticias
        </button>

        <button class="sidebar-item" routerLink="csvp">
          ğŸ“‡ CSV
        </button>

        <button class="sidebar-item" routerLink="crearNoticia">
          ğŸ†• Crear Noticia
        </button>


        <button class="sidebar-item" routerLink="aprobar" *ngIf="auth.isAdmin()">
          ğŸ›ï¸ Solicitudes
        </button>

        <button class="sidebar-item" routerLink="/admin" *ngIf="auth.isAdmin()">
          ğŸ“° GestiÃ³n de noticias
        </button>

        <button class="sidebar-item" routerLink="/rol" *ngIf="auth.isAdmin()">
          ğŸ‘¤ GestiÃ³n de usuarios
        </button>

        <button class="sidebar-item" routerLink="/scrapper" *ngIf="auth.isAdmin()">
          ğŸ§º RecolecciÃ³n de Noticias
        </button>


      </nav>
    </aside>

    <!-- CONTENIDO PRINCIPAL -->
    <section class="app-content">
      <router-outlet></router-outlet>
    </section>
  </div>
</main>

<ng-template #publicLayout>
  <main>
    <router-outlet></router-outlet>
  </main>
</ng-template>




<!-- ğŸ”¥ Overlay de planes -->
<div class="plans-overlay" *ngIf="showPlanes()">
  <!-- fondo oscuro (clic cierra) -->
  <div class="plans-backdrop" (click)="closePlanes()"></div>

  <!-- modal -->
  <div class="plans-modal" (click)="$event.stopPropagation()">
    <div class="plans-header">
      <h2>Planes y MembresÃ­as</h2>
      <button class="icon-btn" (click)="closePlanes()">âœ•</button>
    </div>

    <!-- contenido -->
    <div class="plans-body">
      <!-- loader -->
      <div *ngIf="planesLoading()" class="plans-loading">
        Cargando planes...
      </div>

      <!-- error -->
      <div *ngIf="planesError()" class="plans-error">
        {{ planesError() }}
      </div>

      <!-- listado de cards -->
      <div class="plans-grid" *ngIf="!planesLoading() && !planesError()">
        <div class="plan-card" *ngFor="let plan of planes()">
          <h3>{{ plan.nombre }}</h3>
          <p class="plan-desc">{{ plan.descripcion }}</p>
          <div class="plan-price">
            S/. {{ plan.precio | number:'1.2-2' }}
            <span class="plan-period" *ngIf="isMensual(plan)">
              /mes
            </span>

          </div>

          <ul class="plan-features">
            <li *ngFor="let feature of getPlanFeatures(plan)">
              {{ feature }}
            </li>
          </ul>


          <button
            class="btn plan-btn"
            (click)="seleccionarPlan(plan)">
            Elegir este plan
          </button>
        </div>

        <!-- Por si no hay planes -->
        <div *ngIf="planes().length === 0 && !planesLoading()" class="plans-empty">
          No hay planes disponibles por el momento.
        </div>
      </div>
    </div>
  </div>
</div>
