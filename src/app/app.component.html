<header>
  <div class="container nav">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <h1>Noticias360</h1>
    </div>

    <div class="nav-actions">
      <!-- Bot√≥n de tema -->
      <button class="btn" (click)="toggleTheme()">
        {{ themeLabel }}
      </button>


      <button
        class="btn subscribe-btn"
        (click)="openPlanes()">
        Suscribirme
      </button>




      <!-- Si NO est√° logueado ‚Üí bot√≥n Iniciar sesi√≥n -->
      <button
        class="btn login-btn"
        *ngIf="!isLoggedIn()"
        (click)="goLogin()">
        Iniciar sesi√≥n
      </button>

      <!-- Si S√ç est√° logueado ‚Üí nombre + men√∫ -->
      <div class="user-wrapper" *ngIf="isLoggedIn() && user() as u">
        <button
          type="button"
          class="btn user-btn"
          (click)="toggleUserMenu()">
          {{ u.name }} {{ u.lastName }}
          <span class="chevron">‚åÑ</span>
        </button>

        <!-- Men√∫ desplegable -->
        <div class="user-menu" *ngIf="showUserMenu()">
          <button type="button" (click)="goProfile()">Perfil</button>
          <button type="button" (click)="logout()">Cerrar sesi√≥n</button>
        </div>
      </div>
    </div>
  </div>
</header>

<main *ngIf="isLoggedIn(); else publicLayout">
  <div class="app-layout">
    <!-- BARRA LATERAL -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <span class="sidebar-title">Panel</span>
      </div>

      <nav class="sidebar-nav">
        <button class="sidebar-item" routerLink="/">
          üè† Inicio
        </button>

        <button class="sidebar-item" routerLink="noticiasp">
          üì∞ Noticias
        </button>

        <button class="sidebar-item" routerLink="/admin" *ngIf="auth.isAdmin()">
          üì∞ Gesti√≥n de noticias
        </button>

        <button class="sidebar-item" routerLink="/rol" *ngIf="auth.isAdmin()">
          üë§ Gesti√≥n de usuarios
        </button>

        <button class="sidebar-item" routerLink="/scrapper" *ngIf="auth.isAdmin()">
          üß∫ Recolecci√≥n de Noticias
        </button>


      </nav>
    </aside>

    <!-- CONTENIDO PRINCIPAL -->
    <section class="app-content">
      <router-outlet></router-outlet>
    </section>
  </div>
</main>

<ng-template #publicLayout>
  <main>
    <router-outlet></router-outlet>
  </main>
</ng-template>




<!-- üî• Overlay de planes -->
<div class="plans-overlay" *ngIf="showPlanes()">
  <!-- fondo oscuro (clic cierra) -->
  <div class="plans-backdrop" (click)="closePlanes()"></div>

  <!-- modal -->
  <div class="plans-modal" (click)="$event.stopPropagation()">
    <div class="plans-header">
      <h2>Planes y Membres√≠as</h2>
      <button class="icon-btn" (click)="closePlanes()">‚úï</button>
    </div>

    <!-- contenido -->
    <div class="plans-body">
      <!-- loader -->
      <div *ngIf="planesLoading()" class="plans-loading">
        Cargando planes...
      </div>

      <!-- error -->
      <div *ngIf="planesError()" class="plans-error">
        {{ planesError() }}
      </div>

      <!-- listado de cards -->
      <div class="plans-grid" *ngIf="!planesLoading() && !planesError()">
        <div class="plan-card" *ngFor="let plan of planes()">
          <h3>{{ plan.nombre }}</h3>
          <p class="plan-desc">{{ plan.descripcion }}</p>
          <div class="plan-price">
            S/. {{ plan.precio | number:'1.2-2' }}
            <span class="plan-period" *ngIf="isMensual(plan)">
              /mes
            </span>

          </div>

          <ul class="plan-features">
            <!-- Aqu√≠ puedes poner l√≥gica o texto fijo seg√∫n tipo -->
            <li>Acceso completo a Noticias360</li>
            <li>Navegaci√≥n sin publicidad</li>
            <li>Contenido exclusivo para miembros</li>
          </ul>

          <button
            class="btn plan-btn"
            (click)="seleccionarPlan(plan)">
            Elegir este plan
          </button>
        </div>

        <!-- Por si no hay planes -->
        <div *ngIf="planes().length === 0 && !planesLoading()" class="plans-empty">
          No hay planes disponibles por el momento.
        </div>
      </div>
    </div>
  </div>
</div>
